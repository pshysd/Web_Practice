package com.kh.board.model.service;

import static com.kh.common.JDBCTemplate.*;

import java.sql.Connection;
import java.util.ArrayList;

import com.kh.board.model.dao.BoardDao;
import com.kh.board.model.vo.Attachment;
import com.kh.board.model.vo.Board;
import com.kh.board.model.vo.Category;
import com.kh.common.model.vo.PageInfo;

public class BoardService {

    public int selectListCount() {

        Connection conn = getConnection();

        int listCount = new BoardDao().selectListCount(conn);

        close(conn);

        return listCount;
    }

    public ArrayList<Board> selectList(PageInfo pi) {

        Connection conn = getConnection();

        ArrayList<Board> list = new BoardDao().selectList(conn, pi);

        close(conn);

        return list;
    }

    public ArrayList<Category> selectCategoryList() {
        Connection conn = getConnection();
        
        ArrayList<Category> list = new BoardDao().selectCategoryList(conn);
        
        close(conn);
        
        return list;
    }

    public int insertBoard(Board b, Attachment at) {
        
        Connection conn= getConnection();
        
//        주의사항 => DAO의 메소드 1개 == 쿼리문 1개
        
//        BOARD 테이블 INSERT 요청 먼저(첨부파일이 있든 없든 무조건 일어나야 함)
        int result1 = new BoardDao().insertBoard(conn, b);
        
        if(result1 > 0) {
            commit(conn);
        }else {
            rollback(conn);
        }
        return 0;
    }

}
